import{_ as n,c as s}from"./app.dcda0402.js";const a={},t=s(`<h1 id="selenium\u7B80\u5355\u5E94\u7528-\u722C\u53D6\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#selenium\u7B80\u5355\u5E94\u7528-\u722C\u53D6\u6570\u636E" aria-hidden="true">#</a> Selenium\u7B80\u5355\u5E94\u7528\uFF08\u722C\u53D6\u6570\u636E\uFF09</h1><p>\u73AF\u5883\u642D\u5EFA\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token number">1</span>\u3001pip install selenium
<span class="token number">2</span>\u3001\u4E0B\u8F7D\u5BF9\u5E94\u201CXX\u6D4F\u89C8\u5668\u9A71\u52A8\u201D\uFF0C\u89E3\u538B\u540E\u7684\u6587\u4EF6\u653E\u5728Python\u89E3\u91CA\u5668\u4E2D\uFF0C\uFF08\u6B65\u9AA4\u7701\u7565<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\uFF09
</code></pre></div><p>\u4EE3\u7801\u90E8\u5206\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token number">1</span>\u3001\u5BFC\u5165\u4F7F\u7528\u7684\u6A21\u5757
<span class="token keyword">import</span> time  <span class="token comment">#\u65F6\u95F4\u6A21\u5757</span>
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver <span class="token keyword">import</span> Chrome  <span class="token comment">#\u6D4F\u89C8\u5668\u9A71\u52A8\u6A21\u5757</span>
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>options <span class="token keyword">import</span> Options  <span class="token comment">#\u65E0\u5934\u6D4F\u89C8\u5668\u6A21\u5757</span>
<span class="token keyword">import</span> csv  <span class="token comment">#csv\u7684\u8BFB\u5199\u6A21\u5757</span>

<span class="token number">2</span>\u3001\u914D\u7F6E\u65E0\u5934\u6D4F\u89C8\u5668\u53C2\u6570
opt <span class="token operator">=</span> Options<span class="token punctuation">(</span><span class="token punctuation">)</span>
opt<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--headless&quot;</span><span class="token punctuation">)</span>
opt<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--disbale-gpu&quot;</span><span class="token punctuation">)</span>

<span class="token number">3</span>\u3001\u521B\u5EFA\u4E00\u4E2A\u6D4F\u89C8\u5668\u5BF9\u8C61
web <span class="token operator">=</span> Chrome<span class="token punctuation">(</span>options<span class="token operator">=</span>opt<span class="token punctuation">)</span>  <span class="token comment">#\u521B\u5EFA\u4E00\u4E2A\u6D4F\u89C8\u5668\u5BF9\u8C61</span>
web<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.xinfadi.com.cn/priceDetail.html&quot;</span><span class="token punctuation">)</span>  <span class="token comment">#\u7528\u6D4F\u89C8\u5668\u6253\u5F00\u4E00\u4E2A\u7F51\u7AD9</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># \u4F11\u606F3\u79D2\uFF0Cselenium\u7684\u7F3A\u70B9\u5C31\u662F\u6162\uFF0C\u5FC5\u987B\u7B49\u5F85\u4E0A\u4E00\u6B65\u5B8C\u6210\u540E\u624D\u80FD\u6267\u884C\u4E0B\u4E00\u6B65\u64CD\u4F5C\uFF0C\u5426\u5219\u5BB9\u6613\u62A5\u9519</span>

<span class="token number">4</span>\u3001\u521B\u5EFA\u4E00\u4E2ACSV\u6587\u4EF6
ex <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;xinfadi_caijia2.csv&quot;</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">&quot;w&quot;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf8&quot;</span><span class="token punctuation">)</span>  <span class="token comment">#\u6253\u5F00\u4E00\u4E2A\u6587\u4EF6</span>
csvwriter <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>ex<span class="token punctuation">)</span>  <span class="token comment">#\u8BBE\u7F6E\u5199\u5165\u7684\u8DEF\u5F84</span>

<span class="token number">5</span>\u3001\u83B7\u53D6\u8868\u5934\u7684xpath\uFF0C\u5E76\u5199\u5165csv\u6587\u4EF6
xpath_ex <span class="token operator">=</span> <span class="token string">&#39;//*[@id=&quot;bbs&quot;]/div/div/div/div[4]/div[1]/div/table/thead/tr&#39;</span>  <span class="token comment">#\u8FD0\u7528\u5F00\u53D1\u8005\u5DE5\u5177\uFF0C\u83B7\u53D6\u76EE\u6807\u4FE1\u606F\u7684xpath</span>
ex_header <span class="token operator">=</span> web<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span>xpath_ex<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">)</span>  <span class="token comment">#\u6293\u53D6\u5E76\u8F6C\u6362\u4E3A\u5217\u8868\u4FE1\u606F</span>
<span class="token comment"># print(ex_header)  #\u5230\u8FD9\u6B65\u65F6\u53EF\u4EE5\u5148\u6D4B\u8BD5\u4E00\u4E0B\u662F\u5426\u80FD\u83B7\u53D6\u5230\u4FE1\u606F</span>
csvwriter<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>ex_header<span class="token punctuation">)</span>  <span class="token comment">#\u5C06\u8868\u5934\u5199\u5165csv\u6587\u4EF6</span>

<span class="token number">6</span>\u3001\u8FD0\u7528\u5FAA\u73AF\u6293\u53D6\u5E76\u4FDD\u5B58\u9875\u9762\u4FE1\u606F
num <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># \u521D\u59CB\u5316\u4E00\u4E2A\u9875\u7801\u8BA1\u6570\u5668\uFF0C\u7528\u4E8E\u8BB0\u5F55\u7FFB\u9875\u6B21\u6570</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">19803</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    nr_ex <span class="token operator">=</span> <span class="token string">&#39;//*[@id=&quot;tableBody&quot;]&#39;</span>  <span class="token comment">#\u5185\u5BB9\u7684xpath</span>
    ex_diyiye <span class="token operator">=</span> web<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span>nr_ex<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">)</span>  <span class="token comment">#\u63D0\u53D6\u51FA\u5185\u5BB9</span>
    csvwriter<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>ex_diyiye<span class="token punctuation">)</span>  <span class="token comment">#\u5199\u5165csv\u6587\u4EF6</span>
    num <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span>
    xpath_next <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&#39;//*[@id=&quot;layui-laypage-</span><span class="token interpolation"><span class="token punctuation">{</span>num<span class="token punctuation">}</span></span><span class="token string">&quot;]/a[7]&#39;</span></span>  <span class="token comment">#\u83B7\u53D6\u4E0B\u4E00\u9875\u7684xpath</span>
    click_next <span class="token operator">=</span> web<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span>xpath_next<span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#\u5B9A\u4F4D\u4E0B\u4E00\u9875\u7684xpath</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># \u4F11\u606F3\u79D2</span>

<span class="token comment">#\u540C\u4E0A\uFF0C\u4F5C\u7528\u662F\u6700\u540E\u4E00\u9875\u7684\u5185\u5BB9\u7684\u6293\u53D6\u4E0E\u5199\u5165</span>
nr_ex <span class="token operator">=</span> <span class="token string">&#39;//*[@id=&quot;tableBody&quot;]&#39;</span>  
ex_diyiye <span class="token operator">=</span> web<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span>nr_ex<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">)</span>  
csvwriter<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>ex_diyiye<span class="token punctuation">)</span>  

<span class="token comment">#\u5173\u95ED\u6587\u4EF6</span>
ex<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div>`,5);function p(o,e){return t}var u=n(a,[["render",p],["__file","index.html.vue"]]);export{u as default};
